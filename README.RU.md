# Загрузчик mail.ru

Неофициальный загрузчик файлов в облако mail.ru. Перед использованием ознакомьтесь с официальным лицензионным соглашением (https://cloud.mail.ru/LA/).

## Начало работы

Эта инструкция поможет вам запустить проект на локальной машине в целях разработки и тестирования. Этот проект был создан для выполнения одной очень маленькой цели - время от времени загружать несколько файлов в облако Mail.ru.

### Подготовка к установке

Для запуска загрузчика вам понадобится установить:

Python 3.3+ (2.7+ подойдет) с модулями:
```   
pip install requests requests-toolbelt
```

В системах Windows NT вы также можете использовать готовую собранную версию загрузчика
Для этого установите следующие компоненты: [Visual C++ Redistributable for Visual Studio 2015](https://www.microsoft.com/en-us/download/details.aspx?id=48145).
Затем запустите исполняемый файл mail.ru-uploader.exe.

Убедитесь, что вы обладаете правами на чтение/запись для корневой папки загрузчика, папок upload/uploaded и облака.

### Установка и использование

Установка не требуется. Просто загрузите файл 'upload.py' в папку с файлами, которые нужно загрузить и запустите загрузчик из командной строки:
```     
python -m upload
```
Первый запуск создаст файл настроек  '.config' с несколькими опциями. Вам нужно заполнить их перед следующим запуском, который уже загрузит ваши файлы в облако, если настройки верны. Убедитесь, что вы предоставили правильные адрес электронной почты и пароль от вашей учетной записи в облаке Mail.ru в секции  'Credentials'. Загрузчик не отправляет эти данные третьим сторонам. Обратите внимание, эти данные будут храниться локально в простом текстовом формате. Папка с файлами для загрузки должна находиться в директории загрузчика. Название папки должно быть прописано в значении опции 'UploadPath', по умолчанию это 'upload'.
Вы можете добавить команду в Cron, Планировщик Задач Windows или любой другой планировщик вашей ОС. Не забудьте использовать полный путь к загрузчику. Файлы настроек и логов всегда создаются в папке выполнения команды, которая не обязательно является папкой, где находится исполняемый файл загрузчика. В этом случае укажите рабочую папку исполняемого файла в задаче планировщика.
Облако Mail.ru использует собственную систему архивации. Ваши файлы, скачанные из облака, могут быть заархивированы дважды.

## Запуск тестов (покрытие: 70%)
Установите pytest в вашей виртуальной среде, если еще не установлен:
```
pip install pytest
```

Для запуска тестов из командной строки:
```
py.test
```

Предоставьте данные учетной записи электронной почты, если их нет в файле настроек:
```
py.test --email=your_email@mail.ru --password=your_password
```

Добавьте опцию --runweb для запуска тестов, связанных с облаком
```
py.test --runweb
```

Добавьте опцию --rundirty для запуска тестов, связанных с облаком, которые оставят данные в облачной корзине
```
py.test --rundirty
```

## Лицензия
Этот проект распространяется на условиях лицензии MIT - подробнее в файле [LICENSE](LICENSE).
